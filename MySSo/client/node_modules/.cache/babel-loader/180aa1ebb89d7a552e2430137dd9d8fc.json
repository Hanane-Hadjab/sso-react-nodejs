{"ast":null,"code":"var _jsxFileName = \"/home/addworking/Documents/Addworking/backoffice-front/src/views/Login/Login.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useContext } from \"react\";\nimport GoogleButton from \"react-google-button\";\nimport \"../../styles/css/style.css\";\nimport { UserContext } from \"../../contexts/UserContext\";\nimport { useHistory } from \"react-router\";\nimport { useDispatch } from \"react-redux\";\nimport { setAuthUser, setIsAuthenticated } from \"../../appSlice\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Login = () => {\n  _s();\n\n  const history = useHistory();\n  /*const fetchAuthUser = () => {\n    fetch(process.env.REACT_APP_URL_API_LOGIN + \"/api/v1/auth/user\", {\n      method: \"GET\",\n      credentials: \"include\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    })\n      .then((response) => {\n        console.log(response);\n        return response.json();\n      })\n      .then((response) => {\n        if (response) {\n          console.log(\"User :\", response);\n          setUserIsAuthenticated(true);\n          setUser(response);\n          history.push(\"/dashboard\");\n        }\n      })\n      .catch((error) => console.error(error));\n  }; */\n\n  const dispatch = useDispatch();\n\n  const fetchAuthUser = async () => {\n    const response = await axios.get(\"http://localhost:5000/api/v1/auth/user\", {\n      withCredentials: true\n    }).catch(err => {\n      console.log(\"Not properly authenticated\");\n      dispatch(setIsAuthenticated(false));\n      dispatch(setAuthUser(null));\n      history.push(\"/login/error\");\n    });\n\n    if (response && response.data) {\n      console.log(\"User: \", response.data);\n      dispatch(setIsAuthenticated(true));\n      dispatch(setAuthUser(response.data));\n      history.push(\"/welcome\");\n    }\n  };\n\n  const redirectToGoogleSSO = async () => {\n    let timer = setTimeout(null, 10);\n    const googleLoginURL = process.env.REACT_APP_URL_API_LOGIN + \"/api/v1/login\";\n    const newWindow = window.open(googleLoginURL, \"_blank\", \"width=500,height=600 \");\n\n    if (newWindow) {\n      timer = setInterval(() => {\n        if (newWindow.closed) {\n          console.log(\"Yay we're authenticated\");\n          fetchAuthUser();\n          if (timer) clearInterval(timer);\n        }\n      }, 500);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container-fluid\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-6 offset-3 mt-4\",\n        children: /*#__PURE__*/_jsxDEV(GoogleButton, {\n          onClick: redirectToGoogleSSO\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Login, \"ztFVC0/0rI8de3REyGzb7ruuLNE=\", false, function () {\n  return [useHistory, useDispatch];\n});\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["/home/addworking/Documents/Addworking/backoffice-front/src/views/Login/Login.jsx"],"names":["React","useContext","GoogleButton","UserContext","useHistory","useDispatch","setAuthUser","setIsAuthenticated","axios","Login","history","dispatch","fetchAuthUser","response","get","withCredentials","catch","err","console","log","push","data","redirectToGoogleSSO","timer","setTimeout","googleLoginURL","process","env","REACT_APP_URL_API_LOGIN","newWindow","window","open","setInterval","closed","clearInterval"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,UAAhB,QAAkC,OAAlC;AACA,OAAOC,YAAP,MAAyB,qBAAzB;AACA,OAAO,4BAAP;AACA,SAASC,WAAT,QAA4B,4BAA5B;AACA,SAASC,UAAT,QAA2B,cAA3B;AACA,SAAQC,WAAR,QAA0B,aAA1B;AACA,SAASC,WAAT,EAAsBC,kBAAtB,QAAgD,gBAAhD;AACA,OAAOC,KAAP,MAAkB,OAAlB;;;AACA,MAAMC,KAAK,GAAG,MAAM;AAAA;;AAClB,QAAMC,OAAO,GAAGN,UAAU,EAA1B;AAEA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEE,QAAMO,QAAQ,GAAGN,WAAW,EAA5B;;AACA,QAAMO,aAAa,GAAG,YAAY;AAChC,UAAMC,QAAQ,GAAG,MAAML,KAAK,CACvBM,GADkB,CACd,wCADc,EAC4B;AAACC,MAAAA,eAAe,EAAE;AAAlB,KAD5B,EAElBC,KAFkB,CAEXC,GAAD,IAAS;AACdC,MAAAA,OAAO,CAACC,GAAR,CAAY,4BAAZ;AACAR,MAAAA,QAAQ,CAACJ,kBAAkB,CAAC,KAAD,CAAnB,CAAR;AACAI,MAAAA,QAAQ,CAACL,WAAW,CAAC,IAAD,CAAZ,CAAR;AACAI,MAAAA,OAAO,CAACU,IAAR,CAAa,cAAb;AACD,KAPkB,CAAvB;;AASE,QAAIP,QAAQ,IAAIA,QAAQ,CAACQ,IAAzB,EAA+B;AAC7BH,MAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBN,QAAQ,CAACQ,IAA/B;AACAV,MAAAA,QAAQ,CAACJ,kBAAkB,CAAC,IAAD,CAAnB,CAAR;AACAI,MAAAA,QAAQ,CAACL,WAAW,CAACO,QAAQ,CAACQ,IAAV,CAAZ,CAAR;AACAX,MAAAA,OAAO,CAACU,IAAR,CAAa,UAAb;AACD;AACJ,GAhBD;;AAiBA,QAAME,mBAAmB,GAAG,YAAY;AACtC,QAAIC,KAAK,GAAGC,UAAU,CAAC,IAAD,EAAO,EAAP,CAAtB;AACA,UAAMC,cAAc,GAClBC,OAAO,CAACC,GAAR,CAAYC,uBAAZ,GAAsC,eADxC;AAEA,UAAMC,SAAS,GAAGC,MAAM,CAACC,IAAP,CAChBN,cADgB,EAEhB,QAFgB,EAGhB,uBAHgB,CAAlB;;AAKA,QAAII,SAAJ,EAAe;AACbN,MAAAA,KAAK,GAAGS,WAAW,CAAC,MAAM;AACxB,YAAIH,SAAS,CAACI,MAAd,EAAsB;AACpBf,UAAAA,OAAO,CAACC,GAAR,CAAY,yBAAZ;AACAP,UAAAA,aAAa;AACb,cAAIW,KAAJ,EAAWW,aAAa,CAACX,KAAD,CAAb;AACZ;AACF,OANkB,EAMhB,GANgB,CAAnB;AAOD;AACF,GAlBD;;AAoBA,sBACE;AAAK,IAAA,SAAS,EAAC,iBAAf;AAAA,2BACE;AAAK,MAAA,SAAS,EAAC,KAAf;AAAA,6BACE;AAAK,QAAA,SAAS,EAAC,qBAAf;AAAA,+BACE,QAAC,YAAD;AAAc,UAAA,OAAO,EAAED;AAAvB;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,UADF;AASD,CAzED;;GAAMb,K;UACYL,U,EAyBCC,W;;;KA1BbI,K;AA2EN,eAAeA,KAAf","sourcesContent":["import React, { useContext } from \"react\";\nimport GoogleButton from \"react-google-button\";\nimport \"../../styles/css/style.css\";\nimport { UserContext } from \"../../contexts/UserContext\";\nimport { useHistory } from \"react-router\";\nimport {useDispatch} from \"react-redux\";\nimport { setAuthUser, setIsAuthenticated } from \"../../appSlice\";\nimport axios from \"axios\";\nconst Login = () => {\n  const history = useHistory();\n\n  /*const fetchAuthUser = () => {\n    fetch(process.env.REACT_APP_URL_API_LOGIN + \"/api/v1/auth/user\", {\n      method: \"GET\",\n      credentials: \"include\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    })\n      .then((response) => {\n        console.log(response);\n        return response.json();\n      })\n      .then((response) => {\n        if (response) {\n          console.log(\"User :\", response);\n          setUserIsAuthenticated(true);\n          setUser(response);\n          history.push(\"/dashboard\");\n        }\n      })\n      .catch((error) => console.error(error));\n  }; */\n\n  const dispatch = useDispatch();\n  const fetchAuthUser = async () => {\n    const response = await axios\n        .get(\"http://localhost:5000/api/v1/auth/user\", {withCredentials: true})\n        .catch((err) => {\n          console.log(\"Not properly authenticated\");\n          dispatch(setIsAuthenticated(false));\n          dispatch(setAuthUser(null));\n          history.push(\"/login/error\");\n        });\n\n      if (response && response.data) {\n        console.log(\"User: \", response.data);\n        dispatch(setIsAuthenticated(true));\n        dispatch(setAuthUser(response.data));\n        history.push(\"/welcome\");\n      }\n  }\n  const redirectToGoogleSSO = async () => {\n    let timer = setTimeout(null, 10);\n    const googleLoginURL =\n      process.env.REACT_APP_URL_API_LOGIN + \"/api/v1/login\";\n    const newWindow = window.open(\n      googleLoginURL,\n      \"_blank\",\n      \"width=500,height=600 \"\n    );\n    if (newWindow) {\n      timer = setInterval(() => {\n        if (newWindow.closed) {\n          console.log(\"Yay we're authenticated\");\n          fetchAuthUser();\n          if (timer) clearInterval(timer);\n        }\n      }, 500);\n    }\n  };\n\n  return (\n    <div className=\"container-fluid\">\n      <div className=\"row\">\n        <div className=\"col-6 offset-3 mt-4\">\n          <GoogleButton onClick={redirectToGoogleSSO} />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}